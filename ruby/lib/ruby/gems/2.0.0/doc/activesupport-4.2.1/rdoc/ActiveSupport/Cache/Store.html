<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class ActiveSupport::Cache::Store - activesupport-4.2.1 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/active_support/cache.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link"><a href="../../Object.html">Object</a>
  
</nav>

    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li ><a href="#method-c-instrument">::instrument</a>
    
    <li ><a href="#method-c-instrument-3D">::instrument=</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-cleanup">#cleanup</a>
    
    <li ><a href="#method-i-clear">#clear</a>
    
    <li ><a href="#method-i-decrement">#decrement</a>
    
    <li ><a href="#method-i-delete">#delete</a>
    
    <li ><a href="#method-i-delete_matched">#delete_matched</a>
    
    <li ><a href="#method-i-exist-3F">#exist?</a>
    
    <li ><a href="#method-i-fetch">#fetch</a>
    
    <li ><a href="#method-i-fetch_multi">#fetch_multi</a>
    
    <li ><a href="#method-i-find_cached_entry">#find_cached_entry</a>
    
    <li ><a href="#method-i-get_entry_value">#get_entry_value</a>
    
    <li ><a href="#method-i-handle_expired_entry">#handle_expired_entry</a>
    
    <li ><a href="#method-i-increment">#increment</a>
    
    <li ><a href="#method-i-instrument">#instrument</a>
    
    <li ><a href="#method-i-key_matcher">#key_matcher</a>
    
    <li ><a href="#method-i-log">#log</a>
    
    <li ><a href="#method-i-mute">#mute</a>
    
    <li ><a href="#method-i-namespaced_key">#namespaced_key</a>
    
    <li ><a href="#method-i-read">#read</a>
    
    <li ><a href="#method-i-read_multi">#read_multi</a>
    
    <li ><a href="#method-i-save_block_result_to_cache">#save_block_result_to_cache</a>
    
    <li ><a href="#method-i-silence-21">#silence!</a>
    
    <li ><a href="#method-i-write">#write</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../ActiveSupport.html">ActiveSupport</a>
  
    <li><a href="../../ActiveSupport/Autoload.html">ActiveSupport::Autoload</a>
  
    <li><a href="../../ActiveSupport/BacktraceCleaner.html">ActiveSupport::BacktraceCleaner</a>
  
    <li><a href="../../ActiveSupport/Benchmarkable.html">ActiveSupport::Benchmarkable</a>
  
    <li><a href="../../ActiveSupport/Cache.html">ActiveSupport::Cache</a>
  
    <li><a href="../../ActiveSupport/Cache/Entry.html">ActiveSupport::Cache::Entry</a>
  
    <li><a href="../../ActiveSupport/Cache/FileStore.html">ActiveSupport::Cache::FileStore</a>
  
    <li><a href="../../ActiveSupport/Cache/MemCacheStore.html">ActiveSupport::Cache::MemCacheStore</a>
  
    <li><a href="../../ActiveSupport/Cache/MemCacheStore/LocalCacheWithRaw.html">ActiveSupport::Cache::MemCacheStore::LocalCacheWithRaw</a>
  
    <li><a href="../../ActiveSupport/Cache/MemoryStore.html">ActiveSupport::Cache::MemoryStore</a>
  
    <li><a href="../../ActiveSupport/Cache/NullStore.html">ActiveSupport::Cache::NullStore</a>
  
    <li><a href="../../ActiveSupport/Cache/Store.html">ActiveSupport::Cache::Store</a>
  
    <li><a href="../../ActiveSupport/Cache/Strategy.html">ActiveSupport::Cache::Strategy</a>
  
    <li><a href="../../ActiveSupport/Cache/Strategy/LocalCache.html">ActiveSupport::Cache::Strategy::LocalCache</a>
  
    <li><a href="../../ActiveSupport/Cache/Strategy/LocalCache/LocalCacheRegistry.html">ActiveSupport::Cache::Strategy::LocalCache::LocalCacheRegistry</a>
  
    <li><a href="../../ActiveSupport/Cache/Strategy/LocalCache/LocalStore.html">ActiveSupport::Cache::Strategy::LocalCache::LocalStore</a>
  
    <li><a href="../../ActiveSupport/Cache/Strategy/LocalCache/Middleware.html">ActiveSupport::Cache::Strategy::LocalCache::Middleware</a>
  
    <li><a href="../../ActiveSupport/CachingKeyGenerator.html">ActiveSupport::CachingKeyGenerator</a>
  
    <li><a href="../../ActiveSupport/Callbacks.html">ActiveSupport::Callbacks</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Callback.html">ActiveSupport::Callbacks::Callback</a>
  
    <li><a href="../../ActiveSupport/Callbacks/CallbackChain.html">ActiveSupport::Callbacks::CallbackChain</a>
  
    <li><a href="../../ActiveSupport/Callbacks/CallbackSequence.html">ActiveSupport::Callbacks::CallbackSequence</a>
  
    <li><a href="../../ActiveSupport/Callbacks/ClassMethods.html">ActiveSupport::Callbacks::ClassMethods</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Conditionals.html">ActiveSupport::Callbacks::Conditionals</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Conditionals/Value.html">ActiveSupport::Callbacks::Conditionals::Value</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Filters.html">ActiveSupport::Callbacks::Filters</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Filters/After.html">ActiveSupport::Callbacks::Filters::After</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Filters/Around.html">ActiveSupport::Callbacks::Filters::Around</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Filters/Before.html">ActiveSupport::Callbacks::Filters::Before</a>
  
    <li><a href="../../ActiveSupport/Callbacks/Filters/End.html">ActiveSupport::Callbacks::Filters::End</a>
  
    <li><a href="../../ActiveSupport/Concern.html">ActiveSupport::Concern</a>
  
    <li><a href="../../ActiveSupport/Concern/MultipleIncludedBlocks.html">ActiveSupport::Concern::MultipleIncludedBlocks</a>
  
    <li><a href="../../ActiveSupport/Concurrency.html">ActiveSupport::Concurrency</a>
  
    <li><a href="../../ActiveSupport/Concurrency/Latch.html">ActiveSupport::Concurrency::Latch</a>
  
    <li><a href="../../ActiveSupport/Configurable.html">ActiveSupport::Configurable</a>
  
    <li><a href="../../ActiveSupport/Configurable/ClassMethods.html">ActiveSupport::Configurable::ClassMethods</a>
  
    <li><a href="../../ActiveSupport/Configurable/Configuration.html">ActiveSupport::Configurable::Configuration</a>
  
    <li><a href="../../ActiveSupport/Dependencies.html">ActiveSupport::Dependencies</a>
  
    <li><a href="../../ActiveSupport/Dependencies/Blamable.html">ActiveSupport::Dependencies::Blamable</a>
  
    <li><a href="../../ActiveSupport/Dependencies/ClassCache.html">ActiveSupport::Dependencies::ClassCache</a>
  
    <li><a href="../../ActiveSupport/Dependencies/Loadable.html">ActiveSupport::Dependencies::Loadable</a>
  
    <li><a href="../../ActiveSupport/Dependencies/ModuleConstMissing.html">ActiveSupport::Dependencies::ModuleConstMissing</a>
  
    <li><a href="../../ActiveSupport/Dependencies/WatchStack.html">ActiveSupport::Dependencies::WatchStack</a>
  
    <li><a href="../../ActiveSupport/Deprecation.html">ActiveSupport::Deprecation</a>
  
    <li><a href="../../ActiveSupport/Deprecation/Behavior.html">ActiveSupport::Deprecation::Behavior</a>
  
    <li><a href="../../ActiveSupport/Deprecation/DeprecatedConstantProxy.html">ActiveSupport::Deprecation::DeprecatedConstantProxy</a>
  
    <li><a href="../../ActiveSupport/Deprecation/DeprecatedInstanceVariableProxy.html">ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy</a>
  
    <li><a href="../../ActiveSupport/Deprecation/DeprecatedObjectProxy.html">ActiveSupport::Deprecation::DeprecatedObjectProxy</a>
  
    <li><a href="../../ActiveSupport/Deprecation/DeprecationProxy.html">ActiveSupport::Deprecation::DeprecationProxy</a>
  
    <li><a href="../../ActiveSupport/Deprecation/InstanceDelegator.html">ActiveSupport::Deprecation::InstanceDelegator</a>
  
    <li><a href="../../ActiveSupport/Deprecation/InstanceDelegator/ClassMethods.html">ActiveSupport::Deprecation::InstanceDelegator::ClassMethods</a>
  
    <li><a href="../../ActiveSupport/Deprecation/MethodWrapper.html">ActiveSupport::Deprecation::MethodWrapper</a>
  
    <li><a href="../../ActiveSupport/Deprecation/Reporting.html">ActiveSupport::Deprecation::Reporting</a>
  
    <li><a href="../../ActiveSupport/DeprecationException.html">ActiveSupport::DeprecationException</a>
  
    <li><a href="../../ActiveSupport/DescendantsTracker.html">ActiveSupport::DescendantsTracker</a>
  
    <li><a href="../../ActiveSupport/Duration.html">ActiveSupport::Duration</a>
  
    <li><a href="../../ActiveSupport/FileUpdateChecker.html">ActiveSupport::FileUpdateChecker</a>
  
    <li><a href="../../ActiveSupport/Gzip.html">ActiveSupport::Gzip</a>
  
    <li><a href="../../ActiveSupport/Gzip/Stream.html">ActiveSupport::Gzip::Stream</a>
  
    <li><a href="../../ActiveSupport/HashWithIndifferentAccess.html">ActiveSupport::HashWithIndifferentAccess</a>
  
    <li><a href="../../ActiveSupport/HashWithIndifferentAccess.html">ActiveSupport::HashWithIndifferentAccess</a>
  
    <li><a href="../../ActiveSupport/Inflector.html">ActiveSupport::Inflector</a>
  
    <li><a href="../../ActiveSupport/Inflector/Inflections.html">ActiveSupport::Inflector::Inflections</a>
  
    <li><a href="../../ActiveSupport/Inflector/Inflections/ThreadSafe.html">ActiveSupport::Inflector::Inflections::ThreadSafe</a>
  
    <li><a href="../../ActiveSupport/InheritableOptions.html">ActiveSupport::InheritableOptions</a>
  
    <li><a href="../../ActiveSupport/JSON.html">ActiveSupport::JSON</a>
  
    <li><a href="../../ActiveSupport/JSON/Encoding.html">ActiveSupport::JSON::Encoding</a>
  
    <li><a href="../../ActiveSupport/JSON/Encoding/JSONGemEncoder.html">ActiveSupport::JSON::Encoding::JSONGemEncoder</a>
  
    <li><a href="../../ActiveSupport/JSON/Encoding/JSONGemEncoder/EscapedString.html">ActiveSupport::JSON::Encoding::JSONGemEncoder::EscapedString</a>
  
    <li><a href="../../ActiveSupport/KeyGenerator.html">ActiveSupport::KeyGenerator</a>
  
    <li><a href="../../ActiveSupport/LegacyKeyGenerator.html">ActiveSupport::LegacyKeyGenerator</a>
  
    <li><a href="../../ActiveSupport/LogSubscriber.html">ActiveSupport::LogSubscriber</a>
  
    <li><a href="../../ActiveSupport/LogSubscriber/TestHelper.html">ActiveSupport::LogSubscriber::TestHelper</a>
  
    <li><a href="../../ActiveSupport/LogSubscriber/TestHelper/MockLogger.html">ActiveSupport::LogSubscriber::TestHelper::MockLogger</a>
  
    <li><a href="../../ActiveSupport/Logger.html">ActiveSupport::Logger</a>
  
    <li><a href="../../ActiveSupport/Logger/SimpleFormatter.html">ActiveSupport::Logger::SimpleFormatter</a>
  
    <li><a href="../../ActiveSupport/MessageEncryptor.html">ActiveSupport::MessageEncryptor</a>
  
    <li><a href="../../ActiveSupport/MessageEncryptor/InvalidMessage.html">ActiveSupport::MessageEncryptor::InvalidMessage</a>
  
    <li><a href="../../ActiveSupport/MessageEncryptor/NullSerializer.html">ActiveSupport::MessageEncryptor::NullSerializer</a>
  
    <li><a href="../../ActiveSupport/MessageVerifier.html">ActiveSupport::MessageVerifier</a>
  
    <li><a href="../../ActiveSupport/MessageVerifier/InvalidSignature.html">ActiveSupport::MessageVerifier::InvalidSignature</a>
  
    <li><a href="../../ActiveSupport/Multibyte.html">ActiveSupport::Multibyte</a>
  
    <li><a href="../../ActiveSupport/Multibyte/Chars.html">ActiveSupport::Multibyte::Chars</a>
  
    <li><a href="../../ActiveSupport/Multibyte/Unicode.html">ActiveSupport::Multibyte::Unicode</a>
  
    <li><a href="../../ActiveSupport/Multibyte/Unicode/Codepoint.html">ActiveSupport::Multibyte::Unicode::Codepoint</a>
  
    <li><a href="../../ActiveSupport/Multibyte/Unicode/UnicodeDatabase.html">ActiveSupport::Multibyte::Unicode::UnicodeDatabase</a>
  
    <li><a href="../../ActiveSupport/Notifications.html">ActiveSupport::Notifications</a>
  
    <li><a href="../../ActiveSupport/Notifications/Event.html">ActiveSupport::Notifications::Event</a>
  
    <li><a href="../../ActiveSupport/Notifications/Fanout.html">ActiveSupport::Notifications::Fanout</a>
  
    <li><a href="../../ActiveSupport/Notifications/Fanout/Subscribers.html">ActiveSupport::Notifications::Fanout::Subscribers</a>
  
    <li><a href="../../ActiveSupport/Notifications/Fanout/Subscribers/AllMessages.html">ActiveSupport::Notifications::Fanout::Subscribers::AllMessages</a>
  
    <li><a href="../../ActiveSupport/Notifications/Fanout/Subscribers/Evented.html">ActiveSupport::Notifications::Fanout::Subscribers::Evented</a>
  
    <li><a href="../../ActiveSupport/Notifications/Fanout/Subscribers/Timed.html">ActiveSupport::Notifications::Fanout::Subscribers::Timed</a>
  
    <li><a href="../../ActiveSupport/Notifications/InstrumentationRegistry.html">ActiveSupport::Notifications::InstrumentationRegistry</a>
  
    <li><a href="../../ActiveSupport/Notifications/Instrumenter.html">ActiveSupport::Notifications::Instrumenter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper.html">ActiveSupport::NumberHelper</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberConverter.html">ActiveSupport::NumberHelper::NumberConverter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberToCurrencyConverter.html">ActiveSupport::NumberHelper::NumberToCurrencyConverter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberToDelimitedConverter.html">ActiveSupport::NumberHelper::NumberToDelimitedConverter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberToHumanConverter.html">ActiveSupport::NumberHelper::NumberToHumanConverter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberToHumanSizeConverter.html">ActiveSupport::NumberHelper::NumberToHumanSizeConverter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberToPercentageConverter.html">ActiveSupport::NumberHelper::NumberToPercentageConverter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberToPhoneConverter.html">ActiveSupport::NumberHelper::NumberToPhoneConverter</a>
  
    <li><a href="../../ActiveSupport/NumberHelper/NumberToRoundedConverter.html">ActiveSupport::NumberHelper::NumberToRoundedConverter</a>
  
    <li><a href="../../ActiveSupport/OptionMerger.html">ActiveSupport::OptionMerger</a>
  
    <li><a href="../../ActiveSupport/OrderedHash.html">ActiveSupport::OrderedHash</a>
  
    <li><a href="../../ActiveSupport/OrderedOptions.html">ActiveSupport::OrderedOptions</a>
  
    <li><a href="../../ActiveSupport/PerThreadRegistry.html">ActiveSupport::PerThreadRegistry</a>
  
    <li><a href="../../ActiveSupport/ProxyObject.html">ActiveSupport::ProxyObject</a>
  
    <li><a href="../../ActiveSupport/Railtie.html">ActiveSupport::Railtie</a>
  
    <li><a href="../../ActiveSupport/Rescuable.html">ActiveSupport::Rescuable</a>
  
    <li><a href="../../ActiveSupport/Rescuable/ClassMethods.html">ActiveSupport::Rescuable::ClassMethods</a>
  
    <li><a href="../../ActiveSupport/SafeBuffer.html">ActiveSupport::SafeBuffer</a>
  
    <li><a href="../../ActiveSupport/SafeBuffer/SafeConcatError.html">ActiveSupport::SafeBuffer::SafeConcatError</a>
  
    <li><a href="../../ActiveSupport/SecurityUtils.html">ActiveSupport::SecurityUtils</a>
  
    <li><a href="../../ActiveSupport/StringInquirer.html">ActiveSupport::StringInquirer</a>
  
    <li><a href="../../ActiveSupport/Subscriber.html">ActiveSupport::Subscriber</a>
  
    <li><a href="../../ActiveSupport/SubscriberQueueRegistry.html">ActiveSupport::SubscriberQueueRegistry</a>
  
    <li><a href="../../ActiveSupport/TaggedLogging.html">ActiveSupport::TaggedLogging</a>
  
    <li><a href="../../ActiveSupport/TaggedLogging/Formatter.html">ActiveSupport::TaggedLogging::Formatter</a>
  
    <li><a href="../../ActiveSupport/TestCase.html">ActiveSupport::TestCase</a>
  
    <li><a href="../../ActiveSupport/Testing.html">ActiveSupport::Testing</a>
  
    <li><a href="../../ActiveSupport/Testing/Assertions.html">ActiveSupport::Testing::Assertions</a>
  
    <li><a href="../../ActiveSupport/Testing/ConstantLookup.html">ActiveSupport::Testing::ConstantLookup</a>
  
    <li><a href="../../ActiveSupport/Testing/ConstantLookup/ClassMethods.html">ActiveSupport::Testing::ConstantLookup::ClassMethods</a>
  
    <li><a href="../../ActiveSupport/Testing/Declarative.html">ActiveSupport::Testing::Declarative</a>
  
    <li><a href="../../ActiveSupport/Testing/Deprecation.html">ActiveSupport::Testing::Deprecation</a>
  
    <li><a href="../../ActiveSupport/Testing/Isolation.html">ActiveSupport::Testing::Isolation</a>
  
    <li><a href="../../ActiveSupport/Testing/Isolation/Forking.html">ActiveSupport::Testing::Isolation::Forking</a>
  
    <li><a href="../../ActiveSupport/Testing/Isolation/Subprocess.html">ActiveSupport::Testing::Isolation::Subprocess</a>
  
    <li><a href="../../ActiveSupport/Testing/SetupAndTeardown.html">ActiveSupport::Testing::SetupAndTeardown</a>
  
    <li><a href="../../ActiveSupport/Testing/SetupAndTeardown/ClassMethods.html">ActiveSupport::Testing::SetupAndTeardown::ClassMethods</a>
  
    <li><a href="../../ActiveSupport/Testing/SimpleStubs.html">ActiveSupport::Testing::SimpleStubs</a>
  
    <li><a href="../../ActiveSupport/Testing/TaggedLogging.html">ActiveSupport::Testing::TaggedLogging</a>
  
    <li><a href="../../ActiveSupport/Testing/TimeHelpers.html">ActiveSupport::Testing::TimeHelpers</a>
  
    <li><a href="../../ActiveSupport/TimeWithZone.html">ActiveSupport::TimeWithZone</a>
  
    <li><a href="../../ActiveSupport/TimeZone.html">ActiveSupport::TimeZone</a>
  
    <li><a href="../../ActiveSupport/TimeZone/ThreadSafe.html">ActiveSupport::TimeZone::ThreadSafe</a>
  
    <li><a href="../../ActiveSupport/VERSION.html">ActiveSupport::VERSION</a>
  
    <li><a href="../../ActiveSupport/XMLConverter.html">ActiveSupport::XMLConverter</a>
  
    <li><a href="../../ActiveSupport/XMLConverter/DisallowedType.html">ActiveSupport::XMLConverter::DisallowedType</a>
  
    <li><a href="../../ActiveSupport/XmlMini.html">ActiveSupport::XmlMini</a>
  
    <li><a href="../../ActiveSupport/XmlMini/FileLike.html">ActiveSupport::XmlMini::FileLike</a>
  
    <li><a href="../../ActiveSupport/XmlMini_JDOM.html">ActiveSupport::XmlMini_JDOM</a>
  
    <li><a href="../../ActiveSupport/XmlMini_LibXML.html">ActiveSupport::XmlMini_LibXML</a>
  
    <li><a href="../../ActiveSupport/XmlMini_LibXMLSAX.html">ActiveSupport::XmlMini_LibXMLSAX</a>
  
    <li><a href="../../ActiveSupport/XmlMini_LibXMLSAX/HashBuilder.html">ActiveSupport::XmlMini_LibXMLSAX::HashBuilder</a>
  
    <li><a href="../../ActiveSupport/XmlMini_Nokogiri.html">ActiveSupport::XmlMini_Nokogiri</a>
  
    <li><a href="../../ActiveSupport/XmlMini_Nokogiri/Conversions.html">ActiveSupport::XmlMini_Nokogiri::Conversions</a>
  
    <li><a href="../../ActiveSupport/XmlMini_Nokogiri/Conversions/Document.html">ActiveSupport::XmlMini_Nokogiri::Conversions::Document</a>
  
    <li><a href="../../ActiveSupport/XmlMini_Nokogiri/Conversions/Node.html">ActiveSupport::XmlMini_Nokogiri::Conversions::Node</a>
  
    <li><a href="../../ActiveSupport/XmlMini_Nokogiri/Nokogiri.html">ActiveSupport::XmlMini_Nokogiri::Nokogiri</a>
  
    <li><a href="../../ActiveSupport/XmlMini_Nokogiri/Nokogiri/XML.html">ActiveSupport::XmlMini_Nokogiri::Nokogiri::XML</a>
  
    <li><a href="../../ActiveSupport/XmlMini_NokogiriSAX.html">ActiveSupport::XmlMini_NokogiriSAX</a>
  
    <li><a href="../../ActiveSupport/XmlMini_NokogiriSAX/HashBuilder.html">ActiveSupport::XmlMini_NokogiriSAX::HashBuilder</a>
  
    <li><a href="../../ActiveSupport/XmlMini_REXML.html">ActiveSupport::XmlMini_REXML</a>
  
    <li><a href="../../Array.html">Array</a>
  
    <li><a href="../../Benchmark.html">Benchmark</a>
  
    <li><a href="../../BigDecimal.html">BigDecimal</a>
  
    <li><a href="../../Class.html">Class</a>
  
    <li><a href="../../Date.html">Date</a>
  
    <li><a href="../../DateAndTime.html">DateAndTime</a>
  
    <li><a href="../../DateAndTime/Calculations.html">DateAndTime::Calculations</a>
  
    <li><a href="../../DateAndTime/Zones.html">DateAndTime::Zones</a>
  
    <li><a href="../../DateTime.html">DateTime</a>
  
    <li><a href="../../Digest.html">Digest</a>
  
    <li><a href="../../Digest/UUID.html">Digest::UUID</a>
  
    <li><a href="../../ERB.html">ERB</a>
  
    <li><a href="../../ERB/Util.html">ERB::Util</a>
  
    <li><a href="../../Enumerable.html">Enumerable</a>
  
    <li><a href="../../FalseClass.html">FalseClass</a>
  
    <li><a href="../../File.html">File</a>
  
    <li><a href="../../Float.html">Float</a>
  
    <li><a href="../../Hash.html">Hash</a>
  
    <li><a href="../../I18n.html">I18n</a>
  
    <li><a href="../../I18n/Railtie.html">I18n::Railtie</a>
  
    <li><a href="../../Integer.html">Integer</a>
  
    <li><a href="../../Kernel.html">Kernel</a>
  
    <li><a href="../../LibXML.html">LibXML</a>
  
    <li><a href="../../LibXML/Conversions.html">LibXML::Conversions</a>
  
    <li><a href="../../LibXML/Conversions/Document.html">LibXML::Conversions::Document</a>
  
    <li><a href="../../LibXML/Conversions/Node.html">LibXML::Conversions::Node</a>
  
    <li><a href="../../LibXML/XML.html">LibXML::XML</a>
  
    <li><a href="../../LoadError.html">LoadError</a>
  
    <li><a href="../../LoggerSilence.html">LoggerSilence</a>
  
    <li><a href="../../Marshal.html">Marshal</a>
  
    <li><a href="../../Method.html">Method</a>
  
    <li><a href="../../MissingSourceFile.html">MissingSourceFile</a>
  
    <li><a href="../../Module.html">Module</a>
  
    <li><a href="../../Module/Concerning.html">Module::Concerning</a>
  
    <li><a href="../../Module/DelegationError.html">Module::DelegationError</a>
  
    <li><a href="../../NameError.html">NameError</a>
  
    <li><a href="../../NilClass.html">NilClass</a>
  
    <li><a href="../../Numeric.html">Numeric</a>
  
    <li><a href="../../Object.html">Object</a>
  
    <li><a href="../../Process.html">Process</a>
  
    <li><a href="../../Process/Status.html">Process::Status</a>
  
    <li><a href="../../QualifiedConstUtils.html">QualifiedConstUtils</a>
  
    <li><a href="../../Range.html">Range</a>
  
    <li><a href="../../Regexp.html">Regexp</a>
  
    <li><a href="../../String.html">String</a>
  
    <li><a href="../../Struct.html">Struct</a>
  
    <li><a href="../../Symbol.html">Symbol</a>
  
    <li><a href="../../Thread.html">Thread</a>
  
    <li><a href="../../Time.html">Time</a>
  
    <li><a href="../../TrueClass.html">TrueClass</a>
  
    <li><a href="../../URI.html">URI</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class ActiveSupport::Cache::Store</h1>

  <div id="description" class="description">
    
<p>An abstract cache store class. There are multiple cache store
implementations, each having its own additional features. See the classes
under the <a href="../Cache.html">ActiveSupport::Cache</a> module, e.g. <a
href="MemCacheStore.html">ActiveSupport::Cache::MemCacheStore</a>. <a
href="MemCacheStore.html">MemCacheStore</a> is currently the most popular
cache store for large production websites.</p>

<p>Some implementations may not support all methods beyond the basic cache
methods of <code>fetch</code>, <code>write</code>, <code>read</code>,
<code>exist?</code>, and <code>delete</code>.</p>

<p><a href="Store.html">ActiveSupport::Cache::Store</a> can store any
serializable Ruby object.</p>

<pre class="ruby"><span class="ruby-identifier">cache</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span><span class="ruby-operator">::</span><span class="ruby-constant">MemoryStore</span>.<span class="ruby-identifier">new</span>

<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">read</span>(<span class="ruby-string">&#39;city&#39;</span>)   <span class="ruby-comment"># =&gt; nil</span>
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39;city&#39;</span>, <span class="ruby-string">&quot;Duckburgh&quot;</span>)
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">read</span>(<span class="ruby-string">&#39;city&#39;</span>)   <span class="ruby-comment"># =&gt; &quot;Duckburgh&quot;</span>
</pre>

<p>Keys are always translated into Strings and are case sensitive. When an
object is specified as a key and has a <code>cache_key</code> method
defined, this method will be called to define the key.  Otherwise, the
<code>to_param</code> method will be called. Hashes and Arrays can also be
used as keys. The elements will be delimited by slashes, and the elements
within a <a href="../../Hash.html">Hash</a> will be sorted by key so they
are consistent.</p>

<pre class="ruby"><span class="ruby-identifier">cache</span>.<span class="ruby-identifier">read</span>(<span class="ruby-string">&#39;city&#39;</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">cache</span>.<span class="ruby-identifier">read</span>(:<span class="ruby-identifier">city</span>)   <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>Nil values can be cached.</p>

<p>If your cache is on a shared infrastructure, you can define a namespace for
your cache entries. If a namespace is defined, it will be prefixed on to
every key. The namespace can be either a static value or a Proc. If it is a
Proc, it will be invoked when each key is evaluated so that you can use
application logic to invalidate keys.</p>

<pre>cache.namespace = -&gt; { @last_mod_time }  # Set the namespace to a variable
@last_mod_time = Time.now  # Invalidate the entire cache by changing namespace</pre>

<p>Caches can also store values in a compressed format to save space and
reduce time spent sending data. Since there is overhead, values must be
large enough to warrant compression. To turn on compression either pass
<code>compress: true</code> in the initializer or as an option to
<code>fetch</code> or <code>write</code>. To specify the threshold at which
to compress values, set the <code>:compress_threshold</code> option. The
default threshold is 16K.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-options" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">options</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-silence" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">silence</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-silence-3F" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">silence?</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-instrument" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">instrument</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>:deprecated:</p>
          
          

          
          <div class="method-source-code" id="instrument-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 189</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instrument</span>
  <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">warn</span> <span class="ruby-string">&quot;ActiveSupport::Cache.instrument is deprecated and will be removed in Rails 5. Instrumentation is now always on so you can safely stop using it.&quot;</span>
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- instrument-source -->
          
        </div>

        

        
      </div><!-- instrument-method -->

    
      <div id="method-c-instrument-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">instrument=</span><span
            class="method-args">(boolean)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>:deprecated:</p>
          
          

          
          <div class="method-source-code" id="instrument-3D-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 183</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instrument=</span>(<span class="ruby-identifier">boolean</span>)
  <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">warn</span> <span class="ruby-string">&quot;ActiveSupport::Cache.instrument= is deprecated and will be removed in Rails 5. Instrumentation is now always on so you can safely stop using it.&quot;</span>
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- instrument-3D-source -->
          
        </div>

        

        
      </div><!-- instrument-3D-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a new cache. The options will be passed to any write method calls
except for <code>:namespace</code> which can be used to set the global
namespace for the cache.</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 164</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> {}
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-cleanup" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cleanup</span><span
            class="method-args">(options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Cleanup the cache by removing expired entries.</p>

<p>Options are passed to the underlying cache implementation.</p>

<p>All implementations may not support this method.</p>
          
          

          
          <div class="method-source-code" id="cleanup-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 450</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cleanup</span>(<span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{self.class.name} does not support cleanup&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- cleanup-source -->
          
        </div>

        

        
      </div><!-- cleanup-method -->

    
      <div id="method-i-clear" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clear</span><span
            class="method-args">(options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clear the entire cache. Be careful with this method since it could affect
other processes if shared cache is being used.</p>

<p>The options hash is passed to the underlying cache implementation.</p>

<p>All implementations may not support this method.</p>
          
          

          
          <div class="method-source-code" id="clear-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 460</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clear</span>(<span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{self.class.name} does not support clear&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- clear-source -->
          
        </div>

        

        
      </div><!-- clear-method -->

    
      <div id="method-i-decrement" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">decrement</span><span
            class="method-args">(name, amount = 1, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Decrement an integer value in the cache.</p>

<p>Options are passed to the underlying cache implementation.</p>

<p>All implementations may not support this method.</p>
          
          

          
          <div class="method-source-code" id="decrement-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 441</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decrement</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">amount</span> = <span class="ruby-value">1</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{self.class.name} does not support decrement&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- decrement-source -->
          
        </div>

        

        
      </div><!-- decrement-method -->

    
      <div id="method-i-delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete</span><span
            class="method-args">(name, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Deletes an entry in the cache. Returns <code>true</code> if an entry is
deleted.</p>

<p>Options are passed to the underlying cache implementation.</p>
          
          

          
          <div class="method-source-code" id="delete-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 398</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merged_options</span>(<span class="ruby-identifier">options</span>)

  <span class="ruby-identifier">instrument</span>(<span class="ruby-value">:delete</span>, <span class="ruby-identifier">name</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">delete_entry</span>(<span class="ruby-identifier">namespaced_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>), <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete-source -->
          
        </div>

        

        
      </div><!-- delete-method -->

    
      <div id="method-i-delete_matched" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_matched</span><span
            class="method-args">(matcher, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete all entries with keys matching the pattern.</p>

<p>Options are passed to the underlying cache implementation.</p>

<p>All implementations may not support this method.</p>
          
          

          
          <div class="method-source-code" id="delete_matched-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 423</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_matched</span>(<span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{self.class.name} does not support delete_matched&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_matched-source -->
          
        </div>

        

        
      </div><!-- delete_matched-method -->

    
      <div id="method-i-exist-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">exist?</span><span
            class="method-args">(name, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns <code>true</code> if the cache contains an entry for the given key.</p>

<p>Options are passed to the underlying cache implementation.</p>
          
          

          
          <div class="method-source-code" id="exist-3F-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 409</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merged_options</span>(<span class="ruby-identifier">options</span>)

  <span class="ruby-identifier">instrument</span>(<span class="ruby-value">:exist?</span>, <span class="ruby-identifier">name</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">read_entry</span>(<span class="ruby-identifier">namespaced_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>), <span class="ruby-identifier">options</span>)
    (<span class="ruby-identifier">entry</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">entry</span>.<span class="ruby-identifier">expired?</span>) <span class="ruby-operator">||</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- exist-3F-source -->
          
        </div>

        

        
      </div><!-- exist-3F-method -->

    
      <div id="method-i-fetch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fetch</span><span
            class="method-args">(name, options = nil) { |_name| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Fetches data from the cache, using the given key. If there is data in the
cache with the given key, then that data is returned.</p>

<p>If there is no such data in the cache (a cache miss), then <code>nil</code>
will be returned. However, if a block has been passed, that block will be
passed the key and executed in the event of a cache miss. The return value
of the block will be written to the cache under the given cache key, and
that return value will be returned.</p>

<pre class="ruby"><span class="ruby-identifier">cache</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39;today&#39;</span>, <span class="ruby-string">&#39;Monday&#39;</span>)
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;today&#39;</span>)  <span class="ruby-comment"># =&gt; &quot;Monday&quot;</span>

<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;city&#39;</span>)   <span class="ruby-comment"># =&gt; nil</span>
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;city&#39;</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-string">&#39;Duckburgh&#39;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;city&#39;</span>)   <span class="ruby-comment"># =&gt; &quot;Duckburgh&quot;</span>
</pre>

<p>You may also specify additional options via the <code>options</code>
argument. Setting <code>force: true</code> will force a cache miss:</p>

<pre class="ruby"><span class="ruby-identifier">cache</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39;today&#39;</span>, <span class="ruby-string">&#39;Monday&#39;</span>)
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;today&#39;</span>, <span class="ruby-identifier">force</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)  <span class="ruby-comment"># =&gt; nil</span>
</pre>

<p>Setting <code>:compress</code> will store a large cache entry set by the
call in a compressed format.</p>

<p>Setting <code>:expires_in</code> will set an expiration time on the cache.
All caches support auto-expiring content after a specified number of
seconds. This value can be specified as an option to the constructor (in
which case all entries will be affected), or it can be supplied to the
<code>fetch</code> or <code>write</code> method to effect just one entry.</p>

<pre>cache = ActiveSupport::Cache::MemoryStore.new(expires_in: 5.minutes)
cache.write(key, value, expires_in: 1.minute) # Set a lower value for one entry</pre>

<p>Setting <code>:race_condition_ttl</code> is very useful in situations where
a cache entry is used very frequently and is under heavy load. If a cache
expires and due to heavy load several different processes will try to read
data natively and then they all will try to write to cache. To avoid that
case the first process to find an expired cache entry will bump the cache
expiration time by the value set in <code>:race_condition_ttl</code>. Yes,
this process is extending the time for a stale value by another few
seconds. Because of extended life of the previous cache, other processes
will continue to use slightly stale data for a just a bit longer. In the
meantime that first process will go ahead and will write into cache the new
value. After that all the processes will start getting the new value. The
key is to keep <code>:race_condition_ttl</code> small.</p>

<p>If the process regenerating the entry errors out, the entry will be
regenerated after the specified number of seconds. Also note that the life
of stale cache is extended only if it expired recently. Otherwise a new
value is generated and <code>:race_condition_ttl</code> does not play any
role.</p>

<pre class="ruby"><span class="ruby-comment"># Set all values to expire after one minute.</span>
<span class="ruby-identifier">cache</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span><span class="ruby-operator">::</span><span class="ruby-constant">MemoryStore</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expires_in</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">minute</span>)

<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39;foo&#39;</span>, <span class="ruby-string">&#39;original value&#39;</span>)
<span class="ruby-identifier">val_1</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-identifier">val_2</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-identifier">sleep</span> <span class="ruby-value">60</span>

<span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">val_1</span> = <span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;foo&#39;</span>, <span class="ruby-identifier">race_condition_ttl</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
    <span class="ruby-string">&#39;new value 1&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">val_2</span> = <span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;foo&#39;</span>, <span class="ruby-identifier">race_condition_ttl</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-string">&#39;new value 2&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-comment"># val_1 =&gt; &quot;new value 1&quot;</span>
<span class="ruby-comment"># val_2 =&gt; &quot;original value&quot;</span>
<span class="ruby-comment"># sleep 10 # First thread extend the life of cache by another 10 seconds</span>
<span class="ruby-comment"># cache.fetch(&#39;foo&#39;) =&gt; &quot;new value 1&quot;</span>
</pre>

<p>Other options will be handled by the specific cache store implementation.
Internally, <a href="Store.html#method-i-fetch">fetch</a> calls read_entry,
and calls write_entry on a cache miss. <code>options</code> will be passed
to the <a href="Store.html#method-i-read">read</a> and <a
href="Store.html#method-i-write">write</a> calls.</p>

<p>For example, MemCacheStore&#39;s <a
href="Store.html#method-i-write">write</a> method supports the
<code>:raw</code> option, which tells the memcached server to store all
values as strings. We can use this option with <a
href="Store.html#method-i-fetch">fetch</a> too:</p>

<pre class="ruby"><span class="ruby-identifier">cache</span> = <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span><span class="ruby-operator">::</span><span class="ruby-constant">MemCacheStore</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&quot;foo&quot;</span>, <span class="ruby-identifier">force</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">raw</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span>
  :<span class="ruby-identifier">bar</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-string">&#39;foo&#39;</span>) <span class="ruby-comment"># =&gt; &quot;bar&quot;</span>
</pre>
          
          

          
          <div class="method-source-code" id="fetch-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 288</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merged_options</span>(<span class="ruby-identifier">options</span>)
    <span class="ruby-identifier">key</span> = <span class="ruby-identifier">namespaced_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)

    <span class="ruby-identifier">cached_entry</span> = <span class="ruby-identifier">find_cached_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:force</span>]
    <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">handle_expired_entry</span>(<span class="ruby-identifier">cached_entry</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>
      <span class="ruby-identifier">get_entry_value</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">save_block_result_to_cache</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">_name</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">_name</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- fetch-source -->
          
        </div>

        

        
      </div><!-- fetch-method -->

    
      <div id="method-i-fetch_multi" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fetch_multi</span><span
            class="method-args">(*names) { |name| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Fetches data from the cache, using the given keys. If there is data in the
cache with the given keys, then that data is returned. Otherwise, the
supplied block is called for each key for which there was no data, and the
result will be written to the cache and returned.</p>

<p>Options are passed to the underlying cache implementation.</p>

<p>Returns a hash with the data for each of the names. For example:</p>

<pre class="ruby"><span class="ruby-identifier">cache</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;bim&quot;</span>, <span class="ruby-string">&quot;bam&quot;</span>)
<span class="ruby-identifier">cache</span>.<span class="ruby-identifier">fetch_multi</span>(<span class="ruby-string">&quot;bim&quot;</span>, <span class="ruby-string">&quot;boom&quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span> }
<span class="ruby-comment"># =&gt; { &quot;bam&quot; =&gt; &quot;bam&quot;, &quot;boom&quot; =&gt; &quot;boomboom&quot; }</span>
</pre>
          
          

          
          <div class="method-source-code" id="fetch_multi-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 369</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fetch_multi</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">names</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merged_options</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">results</span> = <span class="ruby-identifier">read_multi</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>, <span class="ruby-identifier">options</span>)

  <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each_with_object</span>({}) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">memo</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">memo</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">results</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">value</span> = <span class="ruby-keyword">yield</span> <span class="ruby-identifier">name</span>
      <span class="ruby-identifier">write</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">options</span>)
      <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- fetch_multi-source -->
          
        </div>

        

        
      </div><!-- fetch_multi-method -->

    
      <div id="method-i-increment" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">increment</span><span
            class="method-args">(name, amount = 1, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Increment an integer value in the cache.</p>

<p>Options are passed to the underlying cache implementation.</p>

<p>All implementations may not support this method.</p>
          
          

          
          <div class="method-source-code" id="increment-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 432</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">increment</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">amount</span> = <span class="ruby-value">1</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{self.class.name} does not support increment&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- increment-source -->
          
        </div>

        

        
      </div><!-- increment-method -->

    
      <div id="method-i-mute" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">mute</span><span
            class="method-args">() { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Silence the logger within a block.</p>
          
          

          
          <div class="method-source-code" id="mute-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 175</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mute</span>
  <span class="ruby-identifier">previous_silence</span>, <span class="ruby-ivar">@silence</span> = <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@silence</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@silence</span>, <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">yield</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-ivar">@silence</span> = <span class="ruby-identifier">previous_silence</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- mute-source -->
          
        </div>

        

        
      </div><!-- mute-method -->

    
      <div id="method-i-read" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">read</span><span
            class="method-args">(name, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Fetches data from the cache, using the given key. If there is data in the
cache with the given key, then that data is returned. Otherwise,
<code>nil</code> is returned.</p>

<p>Options are passed to the underlying cache implementation.</p>
          
          

          
          <div class="method-source-code" id="read-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 311</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merged_options</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">key</span> = <span class="ruby-identifier">namespaced_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">instrument</span>(<span class="ruby-value">:read</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">payload</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">read_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">expired?</span>
        <span class="ruby-identifier">delete_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
        <span class="ruby-identifier">payload</span>[<span class="ruby-value">:hit</span>] = <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">payload</span>
        <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">payload</span>[<span class="ruby-value">:hit</span>] = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">payload</span>
        <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">value</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">payload</span>[<span class="ruby-value">:hit</span>] = <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">payload</span>
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- read-source -->
          
        </div>

        

        
      </div><!-- read-method -->

    
      <div id="method-i-read_multi" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">read_multi</span><span
            class="method-args">(*names)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Read multiple values at once from the cache. Options can be passed in the
last argument.</p>

<p>Some cache implementation may optimize this method.</p>

<p>Returns a hash mapping the names provided to the values found.</p>
          
          

          
          <div class="method-source-code" id="read_multi-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 338</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_multi</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">names</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merged_options</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">results</span> = {}
  <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-identifier">namespaced_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
    <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">read_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">expired?</span>
        <span class="ruby-identifier">delete_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">results</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">value</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">results</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- read_multi-source -->
          
        </div>

        

        
      </div><!-- read_multi-method -->

    
      <div id="method-i-silence-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">silence!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Silence the logger.</p>
          
          

          
          <div class="method-source-code" id="silence-21-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 169</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">silence!</span>
  <span class="ruby-ivar">@silence</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- silence-21-source -->
          
        </div>

        

        
      </div><!-- silence-21-method -->

    
      <div id="method-i-write" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">write</span><span
            class="method-args">(name, value, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Writes the value to the cache, with the key.</p>

<p>Options are passed to the underlying cache implementation.</p>
          
          

          
          <div class="method-source-code" id="write-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 386</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">write</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">merged_options</span>(<span class="ruby-identifier">options</span>)

  <span class="ruby-identifier">instrument</span>(<span class="ruby-value">:write</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">entry</span> = <span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">options</span>)
    <span class="ruby-identifier">write_entry</span>(<span class="ruby-identifier">namespaced_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>), <span class="ruby-identifier">entry</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- write-source -->
          
        </div>

        

        
      </div><!-- write-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Protected Instance Methods</h3>

    
      <div id="method-i-key_matcher" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">key_matcher</span><span
            class="method-args">(pattern, options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add the namespace defined in the options to a pattern designed to match
keys. Implementations that support <a
href="Store.html#method-i-delete_matched">#delete_matched</a> should call
this method to translate a pattern that matches names into one that matches
namespaced keys.</p>
          
          

          
          <div class="method-source-code" id="key_matcher-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 469</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">key_matcher</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">prefix</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:namespace</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Proc</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:namespace</span>].<span class="ruby-identifier">call</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:namespace</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">prefix</span>
    <span class="ruby-identifier">source</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">source</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-string">&#39;^&#39;</span>)
      <span class="ruby-identifier">source</span> = <span class="ruby-identifier">source</span>[<span class="ruby-value">1</span>, <span class="ruby-identifier">source</span>.<span class="ruby-identifier">length</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">source</span> = <span class="ruby-node">&quot;.*#{source[0, source.length]}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;^#{Regexp.escape(prefix)}:#{source}&quot;</span>, <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">pattern</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- key_matcher-source -->
          
        </div>

        

        
      </div><!-- key_matcher-method -->

    
    </section><!-- protected-instance-method-details -->
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Private Instance Methods</h3>

    
      <div id="method-i-find_cached_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_cached_entry</span><span
            class="method-args">(key, name, options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="find_cached_entry-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 555</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_cached_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">instrument</span>(<span class="ruby-value">:read</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">payload</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">payload</span>[<span class="ruby-value">:super_operation</span>] = <span class="ruby-value">:fetch</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">payload</span>
    <span class="ruby-identifier">read_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- find_cached_entry-source -->
          
        </div>

        

        
      </div><!-- find_cached_entry-method -->

    
      <div id="method-i-get_entry_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_entry_value</span><span
            class="method-args">(entry, name, options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_entry_value-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 578</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_entry_value</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">instrument</span>(<span class="ruby-value">:fetch_hit</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">payload</span><span class="ruby-operator">|</span> }
  <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- get_entry_value-source -->
          
        </div>

        

        
      </div><!-- get_entry_value-method -->

    
      <div id="method-i-handle_expired_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">handle_expired_entry</span><span
            class="method-args">(entry, key, options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="handle_expired_entry-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 562</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_expired_entry</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">expired?</span>
    <span class="ruby-identifier">race_ttl</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:race_condition_ttl</span>].<span class="ruby-identifier">to_i</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">race_ttl</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">expires_at</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">race_ttl</span>)
      <span class="ruby-comment"># When an entry has :race_condition_ttl defined, put the stale entry back into the cache</span>
      <span class="ruby-comment"># for a brief period while the entry is begin recalculated.</span>
      <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">expires_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">race_ttl</span>
      <span class="ruby-identifier">write_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">entry</span>, <span class="ruby-value">:expires_in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">race_ttl</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">delete_entry</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">entry</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">entry</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- handle_expired_entry-source -->
          
        </div>

        

        
      </div><!-- handle_expired_entry-method -->

    
      <div id="method-i-instrument" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">instrument</span><span
            class="method-args">(operation, key, options = nil) { |payload| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="instrument-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 542</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">instrument</span>(<span class="ruby-identifier">operation</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">log</span>(<span class="ruby-identifier">operation</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)

  <span class="ruby-identifier">payload</span> = { <span class="ruby-value">:key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">key</span> }
  <span class="ruby-identifier">payload</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">options</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
  <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Notifications</span>.<span class="ruby-identifier">instrument</span>(<span class="ruby-node">&quot;cache_#{operation}.active_support&quot;</span>, <span class="ruby-identifier">payload</span>){ <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">payload</span>) }
<span class="ruby-keyword">end</span></pre>
          </div><!-- instrument-source -->
          
        </div>

        

        
      </div><!-- instrument-method -->

    
      <div id="method-i-log" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">log</span><span
            class="method-args">(operation, key, options = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="log-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 550</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">log</span>(<span class="ruby-identifier">operation</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logger</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">silence?</span>
  <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;Cache #{operation}: #{key}#{options.blank? ? &quot;&quot; : &quot; (#{options.inspect})&quot;}&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- log-source -->
          
        </div>

        

        
      </div><!-- log-method -->

    
      <div id="method-i-namespaced_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">namespaced_key</span><span
            class="method-args">(key, options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Prefix a key with the namespace. Namespace and key will be delimited with a
colon.</p>
          
          

          
          <div class="method-source-code" id="namespaced_key-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 534</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">namespaced_key</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">key</span> = <span class="ruby-identifier">expanded_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">namespace</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:namespace</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>
  <span class="ruby-identifier">prefix</span> = <span class="ruby-identifier">namespace</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Proc</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">namespace</span>.<span class="ruby-identifier">call</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">namespace</span>
  <span class="ruby-identifier">key</span> = <span class="ruby-node">&quot;#{prefix}:#{key}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">prefix</span>
  <span class="ruby-identifier">key</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- namespaced_key-source -->
          
        </div>

        

        
      </div><!-- namespaced_key-method -->

    
      <div id="method-i-save_block_result_to_cache" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_block_result_to_cache</span><span
            class="method-args">(name, options) { |name| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="save_block_result_to_cache-source">
            <pre><span class="ruby-comment"># File lib/active_support/cache.rb, line 583</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_block_result_to_cache</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">instrument</span>(<span class="ruby-value">:generate</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">payload</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">write</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">result</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- save_block_result_to_cache-source -->
          
        </div>

        

        
      </div><!-- save_block_result_to_cache-method -->

    
    </section><!-- private-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.0.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

