<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>module Viewpoint::EWS::FolderAccessors - viewpoint-1.0.0 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/ews/folder_accessors.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="../EWS.html">Viewpoint::EWS</a>
  
  
  </ul>
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li ><a href="#method-i-create_folder_parser">#create_folder_parser</a>
    
    <li ><a href="#method-i-find_folders">#find_folders</a>
    
    <li ><a href="#method-i-find_folders_args">#find_folders_args</a>
    
    <li ><a href="#method-i-find_folders_parser">#find_folders_parser</a>
    
    <li ><a href="#method-i-folder_type">#folder_type</a>
    
    <li ><a href="#method-i-folders">#folders</a>
    
    <li ><a href="#method-i-get_folder">#get_folder</a>
    
    <li ><a href="#method-i-get_folder_args">#get_folder_args</a>
    
    <li ><a href="#method-i-get_folder_by_name">#get_folder_by_name</a>
    
    <li ><a href="#method-i-get_folder_parser">#get_folder_parser</a>
    
    <li ><a href="#method-i-make_folder">#make_folder</a>
    
    <li ><a href="#method-i-map_folder_type">#map_folder_type</a>
    
    <li ><a href="#method-i-mkfolder">#mkfolder</a>
    
    <li ><a href="#method-i-sync_folders">#sync_folders</a>
    
    <li ><a href="#method-i-sync_folders_args">#sync_folders_args</a>
    
    <li ><a href="#method-i-sync_folders_parser">#sync_folders_parser</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../../README_md.html">README</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../Viewpoint.html">Viewpoint</a>
  
    <li><a href="../../Viewpoint/EWS.html">Viewpoint::EWS</a>
  
    <li><a href="../../Viewpoint/EWS/CalendarAccessors.html">Viewpoint::EWS::CalendarAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/Connection.html">Viewpoint::EWS::Connection</a>
  
    <li><a href="../../Viewpoint/EWS/ConnectionHelper.html">Viewpoint::EWS::ConnectionHelper</a>
  
    <li><a href="../../Viewpoint/EWS/ConvertAccessors.html">Viewpoint::EWS::ConvertAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/Errors.html">Viewpoint::EWS::Errors</a>
  
    <li><a href="../../Viewpoint/EWS/Errors/ResponseError.html">Viewpoint::EWS::Errors::ResponseError</a>
  
    <li><a href="../../Viewpoint/EWS/Errors/ServerError.html">Viewpoint::EWS::Errors::ServerError</a>
  
    <li><a href="../../Viewpoint/EWS/Errors/SoapResponseError.html">Viewpoint::EWS::Errors::SoapResponseError</a>
  
    <li><a href="../../Viewpoint/EWS/Errors/UnauthorizedResponseError.html">Viewpoint::EWS::Errors::UnauthorizedResponseError</a>
  
    <li><a href="../../Viewpoint/EWS/Errors/UnhandledResponseError.html">Viewpoint::EWS::Errors::UnhandledResponseError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsBadArgumentError.html">Viewpoint::EWS::EwsBadArgumentError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsCreateItemError.html">Viewpoint::EWS::EwsCreateItemError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsError.html">Viewpoint::EWS::EwsError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsFolderNotFound.html">Viewpoint::EWS::EwsFolderNotFound</a>
  
    <li><a href="../../Viewpoint/EWS/EwsFrozenObjectError.html">Viewpoint::EWS::EwsFrozenObjectError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsItemNotFound.html">Viewpoint::EWS::EwsItemNotFound</a>
  
    <li><a href="../../Viewpoint/EWS/EwsLoginError.html">Viewpoint::EWS::EwsLoginError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsMinimalObjectError.html">Viewpoint::EWS::EwsMinimalObjectError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsNotImplemented.html">Viewpoint::EWS::EwsNotImplemented</a>
  
    <li><a href="../../Viewpoint/EWS/EwsSendItemError.html">Viewpoint::EWS::EwsSendItemError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsServerVersionError.html">Viewpoint::EWS::EwsServerVersionError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsSubscriptionError.html">Viewpoint::EWS::EwsSubscriptionError</a>
  
    <li><a href="../../Viewpoint/EWS/EwsSubscriptionTimeout.html">Viewpoint::EWS::EwsSubscriptionTimeout</a>
  
    <li><a href="../../Viewpoint/EWS/FolderAccessors.html">Viewpoint::EWS::FolderAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/ItemAccessors.html">Viewpoint::EWS::ItemAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/ItemFieldUriMap.html">Viewpoint::EWS::ItemFieldUriMap</a>
  
    <li><a href="../../Viewpoint/EWS/MailboxAccessors.html">Viewpoint::EWS::MailboxAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/MessageAccessors.html">Viewpoint::EWS::MessageAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/PushSubscriptionAccessors.html">Viewpoint::EWS::PushSubscriptionAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/RoomAccessors.html">Viewpoint::EWS::RoomAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/RoomlistAccessors.html">Viewpoint::EWS::RoomlistAccessors</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP.html">Viewpoint::EWS::SOAP</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/CreateAttachmentResponseMessage.html">Viewpoint::EWS::SOAP::CreateAttachmentResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/CreateItemResponseMessage.html">Viewpoint::EWS::SOAP::CreateItemResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsBuilder.html">Viewpoint::EWS::SOAP::EwsBuilder</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsParser.html">Viewpoint::EWS::SOAP::EwsParser</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsResponse.html">Viewpoint::EWS::SOAP::EwsResponse</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsSaxDocument.html">Viewpoint::EWS::SOAP::EwsSaxDocument</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsSoapAvailabilityResponse.html">Viewpoint::EWS::SOAP::EwsSoapAvailabilityResponse</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsSoapFreeBusyResponse.html">Viewpoint::EWS::SOAP::EwsSoapFreeBusyResponse</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsSoapResponse.html">Viewpoint::EWS::SOAP::EwsSoapResponse</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsSoapRoomResponse.html">Viewpoint::EWS::SOAP::EwsSoapRoomResponse</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/EwsSoapRoomlistResponse.html">Viewpoint::EWS::SOAP::EwsSoapRoomlistResponse</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ExchangeAvailability.html">Viewpoint::EWS::SOAP::ExchangeAvailability</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ExchangeDataServices.html">Viewpoint::EWS::SOAP::ExchangeDataServices</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ExchangeNotification.html">Viewpoint::EWS::SOAP::ExchangeNotification</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ExchangeSynchronization.html">Viewpoint::EWS::SOAP::ExchangeSynchronization</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ExchangeTimeZones.html">Viewpoint::EWS::SOAP::ExchangeTimeZones</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ExchangeUserConfiguration.html">Viewpoint::EWS::SOAP::ExchangeUserConfiguration</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ExchangeWebService.html">Viewpoint::EWS::SOAP::ExchangeWebService</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/FindItemResponseMessage.html">Viewpoint::EWS::SOAP::FindItemResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/GetEventsResponseMessage.html">Viewpoint::EWS::SOAP::GetEventsResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/ResponseMessage.html">Viewpoint::EWS::SOAP::ResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/RootFolder.html">Viewpoint::EWS::SOAP::RootFolder</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/SendNotificationResponseMessage.html">Viewpoint::EWS::SOAP::SendNotificationResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/SubscribeResponseMessage.html">Viewpoint::EWS::SOAP::SubscribeResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/SyncFolderHierarchyResponseMessage.html">Viewpoint::EWS::SOAP::SyncFolderHierarchyResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SOAP/SyncFolderItemsResponseMessage.html">Viewpoint::EWS::SOAP::SyncFolderItemsResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/SaveFailed.html">Viewpoint::EWS::SaveFailed</a>
  
    <li><a href="../../Viewpoint/EWS/Template.html">Viewpoint::EWS::Template</a>
  
    <li><a href="../../Viewpoint/EWS/Template/CalendarItem.html">Viewpoint::EWS::Template::CalendarItem</a>
  
    <li><a href="../../Viewpoint/EWS/Template/ForwardItem.html">Viewpoint::EWS::Template::ForwardItem</a>
  
    <li><a href="../../Viewpoint/EWS/Template/Message.html">Viewpoint::EWS::Template::Message</a>
  
    <li><a href="../../Viewpoint/EWS/Template/ReplyToItem.html">Viewpoint::EWS::Template::ReplyToItem</a>
  
    <li><a href="../../Viewpoint/EWS/Template/Task.html">Viewpoint::EWS::Template::Task</a>
  
    <li><a href="../../Viewpoint/EWS/Types.html">Viewpoint::EWS::Types</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Attachment.html">Viewpoint::EWS::Types::Attachment</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Attendee.html">Viewpoint::EWS::Types::Attendee</a>
  
    <li><a href="../../Viewpoint/EWS/Types/CalendarFolder.html">Viewpoint::EWS::Types::CalendarFolder</a>
  
    <li><a href="../../Viewpoint/EWS/Types/CalendarItem.html">Viewpoint::EWS::Types::CalendarItem</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Contact.html">Viewpoint::EWS::Types::Contact</a>
  
    <li><a href="../../Viewpoint/EWS/Types/ContactsFolder.html">Viewpoint::EWS::Types::ContactsFolder</a>
  
    <li><a href="../../Viewpoint/EWS/Types/CopiedEvent.html">Viewpoint::EWS::Types::CopiedEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/CreatedEvent.html">Viewpoint::EWS::Types::CreatedEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/DeletedEvent.html">Viewpoint::EWS::Types::DeletedEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/DistributionList.html">Viewpoint::EWS::Types::DistributionList</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Event.html">Viewpoint::EWS::Types::Event</a>
  
    <li><a href="../../Viewpoint/EWS/Types/ExportItemsResponseMessage.html">Viewpoint::EWS::Types::ExportItemsResponseMessage</a>
  
    <li><a href="../../Viewpoint/EWS/Types/FileAttachment.html">Viewpoint::EWS::Types::FileAttachment</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Folder.html">Viewpoint::EWS::Types::Folder</a>
  
    <li><a href="../../Viewpoint/EWS/Types/FreeBusyChangedEvent.html">Viewpoint::EWS::Types::FreeBusyChangedEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/GenericFolder.html">Viewpoint::EWS::Types::GenericFolder</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Item.html">Viewpoint::EWS::Types::Item</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Item/ClassMethods.html">Viewpoint::EWS::Types::Item::ClassMethods</a>
  
    <li><a href="../../Viewpoint/EWS/Types/ItemAttachment.html">Viewpoint::EWS::Types::ItemAttachment</a>
  
    <li><a href="../../Viewpoint/EWS/Types/MailboxUser.html">Viewpoint::EWS::Types::MailboxUser</a>
  
    <li><a href="../../Viewpoint/EWS/Types/MeetingCancellation.html">Viewpoint::EWS::Types::MeetingCancellation</a>
  
    <li><a href="../../Viewpoint/EWS/Types/MeetingMessage.html">Viewpoint::EWS::Types::MeetingMessage</a>
  
    <li><a href="../../Viewpoint/EWS/Types/MeetingRequest.html">Viewpoint::EWS::Types::MeetingRequest</a>
  
    <li><a href="../../Viewpoint/EWS/Types/MeetingResponse.html">Viewpoint::EWS::Types::MeetingResponse</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Message.html">Viewpoint::EWS::Types::Message</a>
  
    <li><a href="../../Viewpoint/EWS/Types/ModifiedEvent.html">Viewpoint::EWS::Types::ModifiedEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/MovedEvent.html">Viewpoint::EWS::Types::MovedEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/NewMailEvent.html">Viewpoint::EWS::Types::NewMailEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/OutOfOffice.html">Viewpoint::EWS::Types::OutOfOffice</a>
  
    <li><a href="../../Viewpoint/EWS/Types/SearchFolder.html">Viewpoint::EWS::Types::SearchFolder</a>
  
    <li><a href="../../Viewpoint/EWS/Types/StatusEvent.html">Viewpoint::EWS::Types::StatusEvent</a>
  
    <li><a href="../../Viewpoint/EWS/Types/Task.html">Viewpoint::EWS::Types::Task</a>
  
    <li><a href="../../Viewpoint/EWS/Types/TasksFolder.html">Viewpoint::EWS::Types::TasksFolder</a>
  
    <li><a href="../../Viewpoint/EWSClient.html">Viewpoint::EWSClient</a>
  
    <li><a href="../../Viewpoint/StringFormatException.html">Viewpoint::StringFormatException</a>
  
    <li><a href="../../Viewpoint/StringUtils.html">Viewpoint::StringUtils</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module Viewpoint::EWS::FolderAccessors</h1>

  <div id="description" class="description">
    
<p>This file is part of <a href="../../Viewpoint.html">Viewpoint</a>; the Ruby
library for Microsoft Exchange Web Services.</p>

<p>Copyright © 2011 Dan Wanek &lt;dan.wanek@gmail.com&gt;</p>

<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not
use this file except in compliance with the License. You may obtain a copy
of the License at</p>

<pre>http://www.apache.org/licenses/LICENSE-2.0</pre>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
License for the specific language governing permissions and limitations
under the License.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="FOLDER_TYPE_MAP">FOLDER_TYPE_MAP
        
        <dd class="description">
        
      
      </dl>
    </section>
    

    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-find_folders" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">find_folders</span><span
            class="method-args">(opts={})</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="FolderAccessors.html#method-i-folders">folders</a>
        </div>
        
      </div><!-- find_folders-method -->

    
      <div id="method-i-folders" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">folders</span><span
            class="method-args">(opts={}) { |obj| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Find subfolders of the passed root folder.  If no parameters are passed
this method will search from the Root folder. @param [Hash] opts Misc
options to control request @option opts [String,Symbol] :root Either a
FolderId(String) or a</p>

<pre>DistinguishedFolderId(Symbol) . This is where to start the search from.
Usually :root,:msgfolderroot, or :publicfoldersroot</pre>

<p>@option opts [Symbol] :traversal :shallow/:deep/:soft_deleted @option opts
[Symbol] :shape :id_only/:default/:all_properties @option opts [optional,
String] :folder_type an optional folder type to</p>

<pre>limit the search to like &#39;IPF.Task&#39;</pre>

<p>@return [Array] Returns an Array of Folder or subclasses of Folder @raise
[EwsError] raised when the backend <a href="SOAP.html">SOAP</a> method
returns an error.</p>
          
          

          
          <div class="method-source-code" id="folders-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 39</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">folders</span>(<span class="ruby-identifier">opts</span>={})
  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">clone</span>
  <span class="ruby-identifier">args</span> = <span class="ruby-identifier">find_folders_args</span>(<span class="ruby-identifier">opts</span>)
  <span class="ruby-identifier">obj</span> = <span class="ruby-constant">OpenStruct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span><span class="ruby-operator">:</span> <span class="ruby-identifier">args</span>, <span class="ruby-identifier">restriction</span><span class="ruby-operator">:</span> {})
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">obj</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">merge_restrictions!</span> <span class="ruby-identifier">obj</span>
  <span class="ruby-identifier">resp</span> = <span class="ruby-identifier">ews</span>.<span class="ruby-identifier">find_folder</span>( <span class="ruby-identifier">args</span> )
  <span class="ruby-identifier">find_folders_parser</span>(<span class="ruby-identifier">resp</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- folders-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="FolderAccessors.html#method-i-find_folders">find_folders</a>
        </div>
        

        
      </div><!-- folders-method -->

    
      <div id="method-i-get_folder" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_folder</span><span
            class="method-args">(folder_id, opts = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get a specific folder by id or symbol @param [String,Symbol,Hash] folder_id
Either a FolderId(String) or a</p>

<pre>DistinguishedFolderId(Symbol). You can also pass a Hash in the form:
{id: &lt;fold_id&gt;, change_key: &lt;change_key&gt;}</pre>

<p>@param [Hash] opts Misc options to control request @option opts [Symbol]
:shape :id_only/:default/:all_properties @option opts [String,nil] :act_as
User to act on behalf as. This user must</p>

<pre>have been given delegate access to the folder or this operation will fail.</pre>

<p>@raise [EwsError] raised when the backend <a href="SOAP.html">SOAP</a>
method returns an error.</p>
          
          

          
          <div class="method-source-code" id="get_folder-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_folder</span>(<span class="ruby-identifier">folder_id</span>, <span class="ruby-identifier">opts</span> = {})
  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">clone</span>
  <span class="ruby-identifier">args</span> = <span class="ruby-identifier">get_folder_args</span>(<span class="ruby-identifier">folder_id</span>, <span class="ruby-identifier">opts</span>)
  <span class="ruby-identifier">resp</span> = <span class="ruby-identifier">ews</span>.<span class="ruby-identifier">get_folder</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">get_folder_parser</span>(<span class="ruby-identifier">resp</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- get_folder-source -->
          
        </div>

        

        
      </div><!-- get_folder-method -->

    
      <div id="method-i-get_folder_by_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_folder_by_name</span><span
            class="method-args">(name, opts={})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get a specific folder by its name @param [String] name The folder name
@param [Hash] opts Misc options to control request @option opts
[String,Symbol] :parent Either a FolderId(String) or a</p>

<pre>DistinguishedFolderId(Symbol) . This is the parent folder.</pre>

<p>@option opts [Symbol] :shape :id_only/:default/:all_properties @option opts
[String,nil] :act_as User to act on behalf as. This user must</p>

<pre>have been given delegate access to the folder or this operation will fail.</pre>

<p>@raise [EwsError] raised when the backend <a href="SOAP.html">SOAP</a>
method returns an error.</p>
          
          

          
          <div class="method-source-code" id="get_folder_by_name-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 75</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_folder_by_name</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>={})
  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">clone</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:root</span>] = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:parent</span>)
  <span class="ruby-identifier">folders</span>(<span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">restriction</span> = {
      <span class="ruby-value">:is_equal_to</span> =<span class="ruby-operator">&gt;</span>
      [
        {<span class="ruby-value">:field_uRI</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:field_uRI=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&#39;folder:DisplayName&#39;</span>}},
        {<span class="ruby-value">:field_uRI_or_constant</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:constant</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:value=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">name</span>}}}
      ]
    }
  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- get_folder_by_name-source -->
          
        </div>

        

        
      </div><!-- get_folder_by_name-method -->

    
      <div id="method-i-make_folder" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">make_folder</span><span
            class="method-args">(name, opts={})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@param [String] name The name of the new folder @param [Hash] opts @option
opts [String,Symbol] :parent Either a FolderId(String) or a</p>

<pre>DistinguishedFolderId(Symbol) . This is the parent folder.</pre>

<p>@option opts [Symbol] :type the type of folder to create. must be one of</p>

<pre>:folder, :calendar, :contacts, :search, or :tasks</pre>

<p>@see <a
href="http://msdn.microsoft.com/en-us/library/aa580808.aspx">msdn.microsoft.com/en-us/library/aa580808.aspx</a></p>
          
          

          
          <div class="method-source-code" id="make_folder-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">make_folder</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>={})
  <span class="ruby-identifier">parent</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:parent</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:msgfolderroot</span>
  <span class="ruby-identifier">resp</span> = <span class="ruby-identifier">ews</span>.<span class="ruby-identifier">create_folder</span> <span class="ruby-value">:parent_folder_id</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">parent</span>},
    <span class="ruby-value">:folders</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">folder_type</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:type</span>]) =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:display_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>}]
  <span class="ruby-identifier">create_folder_parser</span>(<span class="ruby-identifier">resp</span>).<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- make_folder-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="FolderAccessors.html#method-i-mkfolder">mkfolder</a>
        </div>
        

        
      </div><!-- make_folder-method -->

    
      <div id="method-i-mkfolder" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">mkfolder</span><span
            class="method-args">(name, opts={})</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="FolderAccessors.html#method-i-make_folder">make_folder</a>
        </div>
        
      </div><!-- mkfolder-method -->

    
      <div id="method-i-sync_folders" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sync_folders</span><span
            class="method-args">(opts = {}) { |args| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get a specific folder by id or symbol @param [Hash] opts Misc options to
control request @option opts [Symbol] :shape
:id_only/:default/:all_properties @option opts [String,Symbol,Hash]
:folder_id You can optionally specify a</p>

<pre>folder_id to limit the hierarchy synchronization to it. It must be a
FolderId(String), a DistinguishedFolderId(Symbol) or you can pass a Hash
in the form: {id: &lt;fold_id&gt;, change_key: &lt;change_key&gt;}</pre>

<p>@option opts [String] :sync_state an optional Base64 encoded SyncState</p>

<pre>String from a previous sync call.</pre>

<p>@yield [Hash] yields the formatted argument Hash for last-minute</p>

<pre>modification before calling the backend EWS method.</pre>

<p>@return [Hash] A hash with the following keys</p>

<pre>:all_synced, whether or not additional calls are needed to get all folders
:sync_state, the sync state to use for the next call
and the following optional keys depending on the changes
:create, :update, :delete</pre>

<p>@raise [EwsError] raised when the backend <a href="SOAP.html">SOAP</a>
method returns an error.</p>
          
          

          
          <div class="method-source-code" id="sync_folders-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 121</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sync_folders</span>(<span class="ruby-identifier">opts</span> = {})
  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">clone</span>
  <span class="ruby-identifier">args</span> = <span class="ruby-identifier">sync_folders_args</span>(<span class="ruby-identifier">opts</span>)
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">args</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">resp</span> = <span class="ruby-identifier">ews</span>.<span class="ruby-identifier">sync_folder_hierarchy</span>( <span class="ruby-identifier">args</span> )
  <span class="ruby-identifier">sync_folders_parser</span>(<span class="ruby-identifier">resp</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- sync_folders-source -->
          
        </div>

        

        
      </div><!-- sync_folders-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Private Instance Methods</h3>

    
      <div id="method-i-create_folder_parser" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_folder_parser</span><span
            class="method-args">(resp)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="create_folder_parser-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_folder_parser</span>(<span class="ruby-identifier">resp</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Success&#39;</span>
    <span class="ruby-identifier">folders</span> = <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">response_message</span>[<span class="ruby-value">:elems</span>][<span class="ruby-value">:folders</span>][<span class="ruby-value">:elems</span>]
    <span class="ruby-identifier">folders</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">ftype</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
      <span class="ruby-identifier">class_by_name</span>(<span class="ruby-identifier">ftype</span>).<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ews</span>, <span class="ruby-identifier">f</span>[<span class="ruby-identifier">ftype</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">EwsError</span>, <span class="ruby-node">&quot;Could not create folder. #{resp.code}: #{resp.message}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- create_folder_parser-source -->
          
        </div>

        

        
      </div><!-- create_folder_parser-method -->

    
      <div id="method-i-find_folders_args" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_folders_args</span><span
            class="method-args">(opts)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Build up the arguements for <a
href="FolderAccessors.html#method-i-find_folders">find_folders</a></p>
          
          

          
          <div class="method-source-code" id="find_folders_args-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 133</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_folders_args</span>(<span class="ruby-identifier">opts</span>)
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:root</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:root</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:msgfolderroot</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:traversal</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:traversal</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:shallow</span>
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:default</span>
  <span class="ruby-identifier">folder_id</span> = {<span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:root</span>]}
  <span class="ruby-identifier">folder_id</span>[<span class="ruby-value">:act_as</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:act_as</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:act_as</span>]
  <span class="ruby-keyword">if</span>( <span class="ruby-identifier">opts</span>[<span class="ruby-value">:folder_type</span>] )
    <span class="ruby-identifier">restr</span> = { <span class="ruby-value">:is_equal_to</span> =<span class="ruby-operator">&gt;</span> 
      [
        {<span class="ruby-value">:field_uRI</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:field_uRI=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&#39;folder:FolderClass&#39;</span>}},
        {<span class="ruby-value">:field_uRI_or_constant=</span><span class="ruby-operator">&gt;</span>{<span class="ruby-value">:constant</span> =<span class="ruby-operator">&gt;</span>
          {<span class="ruby-value">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">map_folder_type</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:folder_type</span>])}}},
      ]
    }
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">args</span> = {
    <span class="ruby-value">:parent_folder_ids</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">folder_id</span>],
    <span class="ruby-value">:traversal</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:traversal</span>],
    <span class="ruby-value">:folder_shape</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:base_shape</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>]}
  }
  <span class="ruby-identifier">args</span>[<span class="ruby-value">:restriction</span>] = <span class="ruby-identifier">restr</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">restr</span>
  <span class="ruby-identifier">args</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- find_folders_args-source -->
          
        </div>

        

        
      </div><!-- find_folders_args-method -->

    
      <div id="method-i-find_folders_parser" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_folders_parser</span><span
            class="method-args">(resp)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@param [Viewpoint::EWS::SOAP::EwsSoapResponse] resp</p>
          
          

          
          <div class="method-source-code" id="find_folders_parser-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 158</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_folders_parser</span>(<span class="ruby-identifier">resp</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Success&#39;</span>
    <span class="ruby-identifier">folders</span> = <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">response_message</span>[<span class="ruby-value">:elems</span>][<span class="ruby-value">:root_folder</span>][<span class="ruby-value">:elems</span>][<span class="ruby-value">0</span>][<span class="ruby-value">:folders</span>][<span class="ruby-value">:elems</span>]
    <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">folders</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">folders</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">ftype</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
      <span class="ruby-identifier">class_by_name</span>(<span class="ruby-identifier">ftype</span>).<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ews</span>, <span class="ruby-identifier">f</span>[<span class="ruby-identifier">ftype</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">EwsFolderNotFound</span>, <span class="ruby-node">&quot;Could not retrieve folders. #{resp.code}: #{resp.message}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- find_folders_parser-source -->
          
        </div>

        

        
      </div><!-- find_folders_parser-method -->

    
      <div id="method-i-folder_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">folder_type</span><span
            class="method-args">(type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="folder_type-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 253</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">folder_type</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">type</span>
  <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:folder</span>
    <span class="ruby-value">:folder</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:calendar</span>, <span class="ruby-value">:contacts</span>, <span class="ruby-value">:search</span>, <span class="ruby-value">:tasks</span>
    <span class="ruby-node">&quot;#{type}_folder&quot;</span>.<span class="ruby-identifier">to_sym</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">EwsBadArgumentError</span>, <span class="ruby-node">&quot;Not a proper folder type: :#{type}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- folder_type-source -->
          
        </div>

        

        
      </div><!-- folder_type-method -->

    
      <div id="method-i-get_folder_args" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_folder_args</span><span
            class="method-args">(folder_id, opts)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Build up the arguements for <a
href="FolderAccessors.html#method-i-get_folder">get_folder</a></p>
          
          

          
          <div class="method-source-code" id="get_folder_args-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 184</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_folder_args</span>(<span class="ruby-identifier">folder_id</span>, <span class="ruby-identifier">opts</span>)
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>] <span class="ruby-operator">||=</span> <span class="ruby-value">:default</span>
  <span class="ruby-identifier">default_args</span> =  {
    <span class="ruby-value">:folder_shape</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:base_shape</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>]}
  }
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">folder_id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
    <span class="ruby-identifier">default_args</span>[<span class="ruby-value">:folder_ids</span>] = [<span class="ruby-identifier">folder_id</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">default_args</span>[<span class="ruby-value">:folder_ids</span>] = [{<span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">folder_id</span>}]
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">default_args</span>.<span class="ruby-identifier">merge</span> <span class="ruby-identifier">opts</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- get_folder_args-source -->
          
        </div>

        

        
      </div><!-- get_folder_args-method -->

    
      <div id="method-i-get_folder_parser" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_folder_parser</span><span
            class="method-args">(resp)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>@param [Viewpoint::EWS::SOAP::EwsSoapResponse] resp</p>
          
          

          
          <div class="method-source-code" id="get_folder_parser-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 198</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_folder_parser</span>(<span class="ruby-identifier">resp</span>)
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Success&#39;</span>)
    <span class="ruby-identifier">f</span> = <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">response_message</span>[<span class="ruby-value">:elems</span>][<span class="ruby-value">:folders</span>][<span class="ruby-value">:elems</span>][<span class="ruby-value">0</span>]
    <span class="ruby-identifier">ftype</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">class_by_name</span>(<span class="ruby-identifier">ftype</span>).<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ews</span>, <span class="ruby-identifier">f</span>[<span class="ruby-identifier">ftype</span>])
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">EwsFolderNotFound</span>, <span class="ruby-node">&quot;Could not retrieve folder. #{resp.code}: #{resp.message}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- get_folder_parser-source -->
          
        </div>

        

        
      </div><!-- get_folder_parser-method -->

    
      <div id="method-i-map_folder_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">map_folder_type</span><span
            class="method-args">(type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Map a passed parameter to a know folder type mapping. If no mapping exits
simply allow the passed in type to be passed to the <a
href="SOAP.html">SOAP</a> call. @param [Symbol] type a symbol in <a
href="FolderAccessors.html#FOLDER_TYPE_MAP">FOLDER_TYPE_MAP</a></p>
          
          

          
          <div class="method-source-code" id="map_folder_type-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">map_folder_type</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-constant">FOLDER_TYPE_MAP</span>[<span class="ruby-identifier">type</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">type</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- map_folder_type-source -->
          
        </div>

        

        
      </div><!-- map_folder_type-method -->

    
      <div id="method-i-sync_folders_args" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sync_folders_args</span><span
            class="method-args">(opts)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="sync_folders_args-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 208</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sync_folders_args</span>(<span class="ruby-identifier">opts</span>)
  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:default</span>
  <span class="ruby-identifier">args</span> = { <span class="ruby-value">:folder_shape</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:base_shape</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:shape</span>]} }
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:folder_id</span>]
    <span class="ruby-identifier">folder_id</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:folder_id</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">folder_id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">args</span>[<span class="ruby-value">:sync_folder_id</span>] = <span class="ruby-identifier">folder_id</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">args</span>[<span class="ruby-value">:sync_folder_id</span>] = {<span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">folder_id</span>}
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">args</span>[<span class="ruby-value">:sync_state</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:sync_state</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:sync_state</span>]
  <span class="ruby-identifier">args</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- sync_folders_args-source -->
          
        </div>

        

        
      </div><!-- sync_folders_args-method -->

    
      <div id="method-i-sync_folders_parser" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sync_folders_parser</span><span
            class="method-args">(resp)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="sync_folders_parser-source">
            <pre><span class="ruby-comment"># File lib/ews/folder_accessors.rb, line 223</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sync_folders_parser</span>(<span class="ruby-identifier">resp</span>)
  <span class="ruby-identifier">rmsg</span> = <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">response_messages</span>[<span class="ruby-value">0</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">rmsg</span>.<span class="ruby-identifier">success?</span>
    <span class="ruby-identifier">rhash</span> = {}
    <span class="ruby-identifier">rhash</span>[<span class="ruby-value">:all_synced</span>] = <span class="ruby-identifier">rmsg</span>.<span class="ruby-identifier">includes_last_folder_in_range?</span>
    <span class="ruby-identifier">rhash</span>[<span class="ruby-value">:sync_state</span>] = <span class="ruby-identifier">rmsg</span>.<span class="ruby-identifier">sync_state</span>
    <span class="ruby-identifier">rmsg</span>.<span class="ruby-identifier">changes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">ctype</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
      <span class="ruby-identifier">rhash</span>[<span class="ruby-identifier">ctype</span>] = [] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">rhash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">ctype</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">ctype</span> <span class="ruby-operator">==</span> <span class="ruby-value">:delete</span>
        <span class="ruby-identifier">rhash</span>[<span class="ruby-identifier">ctype</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>[<span class="ruby-identifier">ctype</span>][<span class="ruby-value">:elems</span>][<span class="ruby-value">0</span>][<span class="ruby-value">:folder_id</span>][<span class="ruby-value">:attribs</span>]
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">type</span> = <span class="ruby-identifier">c</span>[<span class="ruby-identifier">ctype</span>][<span class="ruby-value">:elems</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
        <span class="ruby-identifier">item</span> = <span class="ruby-identifier">class_by_name</span>(<span class="ruby-identifier">type</span>).<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ews</span>, <span class="ruby-identifier">c</span>[<span class="ruby-identifier">ctype</span>][<span class="ruby-value">:elems</span>][<span class="ruby-value">0</span>][<span class="ruby-identifier">type</span>])
        <span class="ruby-identifier">rhash</span>[<span class="ruby-identifier">ctype</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">item</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">rhash</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">EwsError</span>, <span class="ruby-node">&quot;Could not synchronize folders. #{rmsg.response_code}: #{rmsg.message_text}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- sync_folders_parser-source -->
          
        </div>

        

        
      </div><!-- sync_folders_parser-method -->

    
    </section><!-- private-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.0.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

